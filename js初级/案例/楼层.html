<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            list-style: none;
        }
        
        #box .main {
            width: 100%;
            height: 500px;
            text-align: center;
            font-size: 80px;
            color: #fff;
        }
        
        #box .main1 {
            background: #156D8E;
            height: 800px;
        }
        
        #box .main2 {
            background: red;
            height: 300px;
        }
        
        #box .main3 {
            background: green;
            height: 400px;
        }
        
        #box .main4 {
            background: blue;
            height: 600px;
        }
        
        #box .main5 {
            background: #F06;
            height: 1000px;
        }
        
        #box .main6 {
            background: #0ff;
            height: 800px;
        }
        
        #mainUl {
            position: fixed;
            right: 10px;
            top: 50px;
        }
        
        #mainUl li {
            font-size: 16px;
            margin: 5px 0;
            padding: 5px 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            background: #fff;
            color: #333;
        }
        
        #mainUl li.active {
            background: #f00;
            color: #fff;
        }
        
        #hr {
            position: fixed;
            width: 100%;
            height: 1px;
            background: #000;
            top: 50%;
            left: 0;
            z-index: 2;
        }
    </style>
    <script>
        function getPos(obj) {
            var o = {
                left: 0,
                top: 0
            };
            while (obj) {
                o.left += obj.offsetLeft;
                o.top += obj.offsetTop;
                obj = obj.offsetParent;
            }
            return o;
        }
        window.onload = function() {
            var oBox = document.getElementById('box');
            var aDiv = oBox.getElementsByTagName('div');
            var oUl = document.getElementById('mainUl');
            var aLi = oUl.getElementsByTagName('li');
            var viewH = document.documentElement.clientHeight; // 可视区的高

            // 根据div的个数，创建li
            for (var i = 0; i < aDiv.length; i++) {
                var oLi = document.createElement('li');
                if (i === 0) {
                    oLi.className = 'active';
                }
                oLi.innerHTML = i + 1;
                oUl.appendChild(oLi);
            }


            // 存储每一个楼层顶边到文档的距离和底边到文档的距离，为一个二维数组
            var arr = [];
            for (var i = 0; i < aDiv.length; i++) {
                var top = getPos(aDiv[i]).top;
                arr.push([top, top + aDiv[i].offsetHeight]);
            }

            // 滚动滚动条，相应楼层小标显示
            document.onscroll = function() {
                var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                var t = scrollTop + viewH / 2;
                for (var i = 0; i < arr.length; i++) {
                    if (t >= arr[i][0] && t <= arr[i][1]) {
                        for (var j = 0; j < aLi.length; j++) {
                            aLi[j].className = '';
                        }
                        aLi[i].className = 'active';
                    }
                }
            }

            // 点击楼层小标，到相应楼层
            for (var i = 0; i < aLi.length; i++) {
                aLi[i].index = i;
                aLi[i].onclick = function() {
                    var top = arr[this.index][0];
                    document.documentElement.scrollTop = top;
                    document.body.scrollTop = top;
                }
            }

        }
    </script>
</head>

<body>
    <div id="box">
        <div class="main main1">一楼</div>
        <div class="main main2">二楼</div>
        <div class="main main3">三楼</div>
        <div class="main main4">四楼</div>
        <div class="main main5">五楼</div>
        <div class="main main6">六楼</div>
    </div>
    <ul id="mainUl"></ul>
    <div id="hr"></div>
</body>

</html>