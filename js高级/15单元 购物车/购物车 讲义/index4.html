<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<script type="text/javascript">
			window.onload = function (){
				var oUl = document.getElementsByTagName('ul')[0];
				var aLi = oUl.getElementsByTagName('li');
				var aB = oUl.getElementsByTagName('b');
				var aStrong = oUl.getElementsByTagName('strong');
				var aInput = oUl.getElementsByTagName('input'); // 单个选项
				var All = document.getElementById("all"); // 全选
				var oP = document.getElementsByTagName('p')[0];
				
				
				// 函数传参
				for (var i=0; i<aLi.length; i++) {
					jisuan(aLi[i]);
				}
				
				function jisuan(obj){
					var aBtn = obj.getElementsByTagName('button');
					var oB = obj.getElementsByTagName('b')[0];
					var oEm = obj.getElementsByTagName('em')[0];
					var oStrong = obj.getElementsByTagName('strong')[0];
					var num = oB.innerHTML;
					var price = oEm.innerHTML;
					
					// 减减
					aBtn[0].onclick = function (){
						num --;
						if (num <= 0) {
							num = 0;
						}
						fn();
					}
					
					// 加加
					aBtn[1].onclick = function (){
						num ++;
						fn();
					}
					
					function fn(){
						oB.innerHTML = num;
						oStrong.innerHTML = price * num;
						auto();
					}
					
				}
				
				// 计算总价及件数
				function auto(){
					var count = 0;
					var money = 0;
					for (var i=0; i<aB.length; i++) {
						if (aInput[i].checked) {
							count += aB[i].innerHTML*1;
							money += aStrong[i].innerHTML*1;
						}
					}
					oP.innerHTML = '商品合计共：'+ count +'件，共花费了：'+ money +'元'
				}
				
				// 单个选上
				for (var i=0; i<aInput.length; i++) {
					aInput[i].onclick = function (){
						var count = 0;
						for (var i=0; i<aInput.length; i++) {
							if (aInput[i].checked) {
								count ++;
							}
						}
						if (count === aInput.length) {
							All.checked = true;
						}else{
							All.checked = false;
						}
						
						auto();
					}
				}
				
				All.onclick = function (){
					for (var i=0; i<aInput.length; i++) {
						aInput[i].checked = this.checked;
					}
					auto();
				}
				
			}
			
			
		</script>
	</head>
	<body>
		<ul>
			<li>
				<input type="checkbox" />
				<button>-</button>
				<b>0</b>
				<button>+</button>
				单价：
				<em>12.5</em>
				元&nbsp;&nbsp;
				小计：
				<strong>0</strong>
				元
			</li>
			<li>
				<input type="checkbox" />
				<button>-</button>
				<b>0</b>
				<button>+</button>
				单价：
				<em>10</em>
				元&nbsp;&nbsp;
				小计：
				<strong>0</strong>
				元
			</li>
			<li>
				<input type="checkbox" />
				<button>-</button>
				<b>0</b>
				<button>+</button>
				单价：
				<em>16.5</em>
				元&nbsp;&nbsp;
				小计：
				<strong>0</strong>
				元
			</li>
			<li>
				<input type="checkbox" />
				<button>-</button>
				<b>0</b>
				<button>+</button>
				单价：
				<em>9.5</em>
				元&nbsp;&nbsp;
				小计：
				<strong>0</strong>
				元
			</li>
		</ul>
		全选：<input type="checkbox" id="all" />
		<p>商品合计共：0件，共花费了：0元</p>
	</body>
</html>
