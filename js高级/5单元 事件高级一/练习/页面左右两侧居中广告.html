<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
<style>
.ad{width:150px;height:400px;background:#f00;position:absolute;}
</style>

<script>

window.onload = function(){
	var aAd = getElementsByClassName( document,"ad" );
	
	aAd[0].style.left = 0;
	aAd[1].style.right = 0;
	
	init();
	window.onresize = window.onscroll = init;
	
	function init(){
		for( var i=0;i<aAd.length;i++ ){
			targetedAds( aAd[i] );
		};
	}
	
	function targetedAds(obj){
		var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
		var oDivH = parseInt( getStyle( obj, "height" ) );
		obj.style.top = ( document.documentElement.clientHeight - oDivH ) / 2 + scrollTop + "px";
	};

}



//通过class获取元素。格式：getElementsByClassName( 搜索起点-祖先级,类名 );	//IE8以上通过新方法获取。IE8及以下用老方法获取。
function getElementsByClassName( node,classname ){
	if( node.getElementsByClassName ){
		return node.getElementsByClassName( classname );
	}else{
		var arr = [];
		var elems = node.getElementsByTagName( "*" );
		for( var i=0;i<elems.length;i++ ){
			var aClassName = elems[i].className.split(" ");
			for( var j=0;j<aClassName.length;j++ ){
				if( aClassName[j] == classname ){
					arr.push( elems[i] );
					break;
				}
			}
		}
		return arr;
	}
}

//获取元素的样式属性值。使用方法：getStyle（元素，"样式属性名"）;getStyle(oDiv,"width");
//注意一点，获取background时，要用backgroundColor。要用单一样式。不要用复合样式。有兼容性的问题。而且不要拿来做判断。还有，不要用来获取没有给元素设置的样式。
function getStyle( obj, attr ){
	if( obj.currentStyle ){
		return obj.currentStyle[attr];
	}else{
		return getComputedStyle( obj )[attr];
	}
};


</script>

</head>

<body style="height:3000px;">

<div class="ad"></div>
<div class="ad"></div>


</body>
</html>
