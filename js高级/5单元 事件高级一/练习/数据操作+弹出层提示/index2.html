<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Untitled Document</title>
<link href="css.css" rel="stylesheet" type="text/css" />
<script src="data.js"></script>
<script>
window.onload = function(){
	var oContainer = document.getElementById("container");
	var oHeader = document.getElementById("header");
	var aHeaderLi = oHeader.getElementsByTagName("li");
	var oListContent = document.getElementById("listContent");
	var aListContentUl = oListContent.getElementsByTagName("ul");
	
	var oTips = document.getElementById("tips");
	var oArrow = document.getElementById("arrow");
	var oTipsContent = document.getElementById("tipsContent");
	
	var num = 0;
	//初始化
	for( var i=0;i<data.length;i++ ){		//data.length长度为2
		//添加标题
		var oLi = document.createElement("li");
		oLi.index = i;
		oLi.innerHTML = data[i]['name'];
		oHeader.appendChild(oLi);
		
		//添加内容
		var oUl = document.createElement("ul");
		oUl.index = i;
		
		var Con = data[i]['list'];			//这里的这个是前端或后端的数据内容，是一个数组，下面再循环这个数组
		for( var j=0;j<Con.length;j++ ){
			var oLi = document.createElement("li");
			oLi.index = j;
			oLi.innerHTML = '<a href="javascript:;">'+ Con[j].title +'</a>';	//添加li
			
			//为每个li添加事件，为了用上面j这个变量，这里用了一个闭包
			(function(j){
				
				oLi.onmouseover = function(){
					Con = data[this.parentNode.index]['list'];		//重新获取一下内容
					
					var L = getPos(this).left;						//得到它的座标
					var T = getPos(this).top;
					var W = this.children[0].offsetWidth;			//得到它下面子元素的宽度
					
					//console.log(W);

					oTips.style.display = "block"
					oTips.style.left = L + W + 15 + "px";
					oTips.style.top = (T - 108) + "px";
					
					//循环一下Con[j]这个json
					for( var attr in Con[j] ){
						var li = document.createElement("li");
						li.innerHTML = Con[j][attr];
						oTipsContent.appendChild(li);
					}
				}
				
				
				oLi.onmouseout = function(){
					oTips.style.display = "none";
					oTipsContent.innerHTML = "";
				}

			})(j)
			
			
			
			oUl.appendChild(oLi);
		}
		oListContent.appendChild(oUl);
		
		
	}
	
	//初始化显示隐藏
	init();
	function init(){
		for( var i=0;i<aHeaderLi.length;i++ ){
			//aHeaderLi[i].index = i;			//上面已经添加了索引值，这里就不必要了
			//aListContentUl[i].index = i;
			aHeaderLi[i].className = ""
			aListContentUl[i].style.display = "none";
		}
		aHeaderLi[num].className = "focus";
		aListContentUl[num].style.display = "block";
	}
	
	//点击切换
	for( var i=0;i<aHeaderLi.length;i++ ){
		aHeaderLi[i].onclick = function(){
			num = this.index;
			init();
		}
	}
	
	
	
}

//返回元素到浏览器左边和顶部的绝对值(不带单位)。用法：getPos(元素).left	返回元素到浏览器左边的绝对值。getPos(元素).top	返回元素到浏览器顶部的绝对值
function getPos(obj) {
	var pos = {left:0, top:0};
	while (obj) {
		pos.left += obj.offsetLeft;
		pos.top += obj.offsetTop;
		obj = obj.offsetParent;
	};
	return pos;
};




</script>
</head>

<body>
	<div id="container">
		<ul id="header"></ul>
		
		<div id="listContent"></div>
	</div>
	
	<div id="tips">
		<span id="arrow"></span>
        <div id="tipsContent"></div>
	</div>
</body>
</html>